"use strict";exports.id=7370,exports.ids=[7370],exports.modules={27370:(e,n,t)=>{t.r(n),t.d(n,{AwaitingSolToEvmBridgingScreen:()=>I,default:()=>I});var a=t(45512),r=t(90788),s=t(58009),o=t(98001),i=t(75185),d=t(65500),l=t(18064),c=t(75005),u=t(7666),g=t(98434),f=t(8601),h=t(76284),m=t(66658),p=t(37782),w=t(52760),v=t(87237),S=t(64179),T=t(71468),C=t(49621);t(5327),t(7623),t(61889);let I={component:function(){let e=(0,f.u)(),{closePrivyModal:n,createAnalyticsEvent:t,connectors:I}=(0,h.u)(),{navigate:b,setModalData:y,data:x}=(0,p.a)(),A=(0,f.u)(),F=(0,s.useRef)(!1),N=(0,S.a)(),[E,U]=(0,s.useState)(!1),[j,R]=(0,s.useState)(!1),[W,B]=(0,s.useState)(null),[D,$]=(0,s.useState)(),[k,L]=(0,s.useState)();if(!x?.funding||"ethereum"!==x.funding.chainType)throw Error("Invalid funding data");let{amount:P,connectedWallet:_,chain:M,solanaChain:O,isUSDC:q}=x.funding,H=x.funding.address,Q=x.funding.erc20Address,V=x.funding.isUSDC?"USDC":M.nativeCurrency.symbol,Y=(0,s.useMemo)(()=>"solana"===_?.type?_.provider:function({connectors:e,connectedWalletAddress:n}){let t=e.find(e=>"solana"===e.chainType&&e.wallets.some(e=>e.address===n)),a=t?.wallet.accounts.find(e=>e.address===n);if(!t||!a)throw new h.a("Unable to find source wallet connector");return new i.W({wallet:t.wallet,account:a})}({connectors:I,connectedWalletAddress:_?.address||""}),[_,I]),z=(0,s.useMemo)(()=>{let n=N(S.S);if(!n)throw new h.a("Unable to load solana plugin");let t=e.solanaRpcs["solana:mainnet"];if(!t)throw new h.a("Unable to load mainnet RPC");return n.getSolanaRpcClient({rpc:t.rpc,rpcSubscriptions:t.rpcSubscriptions,chain:"solana:mainnet",blockExplorerUrl:t.blockExplorerUrl??"https://explorer.solana.com"})},[]),G=(0,m.Q)((0,C.t)(Y?.standardWallet.name||"unknown")),J=G?.name||"wallet";return(0,s.useEffect)(()=>{(async function(){if(!Y||!M||F.current)return;let e=N(S.S);if(!e)return void B(new h.a("Unable to solana plugin"));F.current=!0,M?.testnet&&console.warn("Solana testnets are not supported for bridging");let n=q?1e6*parseFloat(P):(0,o.g)(P),t=await (0,v.g)({isTestnet:!!M.testnet,input:(0,v.t)({appId:A.id,amount:n.toString(),user:Y.address,recipient:H,destinationChainId:M.id,originChainId:v.b,originCurrency:q?v.d:v.a,destinationCurrency:q?Q:void 0})}).catch(console.error);if(!t)return void B(new h.a(`Unable to fetch quotes for bridging. Wallet ${(0,m.a6)(Y.address)} does not have enough funds.`,void 0,h.b.INSUFFICIENT_BALANCE));let a=await e.createTransactionFromRelayQuote({quote:t,source:Y.address,solanaClient:z});if(a)try{U(!0);let n=await e.simulateTransaction({solanaClient:z,tx:a});if(n.hasError)return n.hasFunds?(console.error("Transaction failed:",n.error),void B(new h.a("Something went wrong",void 0,h.b.TRANSACTION_FAILURE))):void B(new h.a(`Wallet ${(0,m.a6)(Y?.address)} does not have enough funds. ${t.details.currencyIn.amountFormatted} ${V} are needed to complete the transaction.`,void 0,h.b.INSUFFICIENT_BALANCE));let{signature:r}=await Y.signAndSendTransaction({chain:"solana:mainnet",transaction:a}),s=e.getAddressFromBuffer(r);$(s),L("pending")}catch(e){if(console.error(e),/user rejected the request/gi.test(e.message||""))return void B(new h.a("Transaction was rejected by the user",void 0,h.b.TRANSACTION_FAILURE));B(new h.a("Something went wrong",void 0,h.b.TRANSACTION_FAILURE))}else B(new h.a(`Unable to select bridge option from quotes. Wallet ${(0,m.a6)(Y.address)} does not have enough funds.`,void 0,h.b.INSUFFICIENT_BALANCE))})().catch(console.error)},[]),(0,v.u)({transactionHash:D,isTestnet:!1,bridgingStatus:k,setBridgingStatus:L,onSuccess({transactionHash:e}){U(!1),R(!0),t({eventName:w.O,payload:{provider:"external",status:"success",txHash:e,address:Y.address,chainType:"solana",clusterName:O,token:"SOL",destinationAddress:H,destinationChainId:M.id,destinationChainType:"ethereum",destinationValue:P,destinationToken:q?"USDC":"ETH"}})},onFailure({error:e}){U(!1),B(e)}}),(0,s.useEffect)(()=>{if(!j)return;let e=setTimeout(n,f.t);return()=>clearTimeout(e)},[j]),(0,s.useEffect)(()=>{W&&(y({funding:x?.funding,solanaFundingData:x?.solanaFundingData,sendTransaction:x?.sendTransaction,errorModalData:{error:W,previousScreen:"TransferFromWalletScreen"}}),b("ErrorScreen",!1))},[W]),j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.t,{}),(0,a.jsx)(d.b,{}),(0,a.jsxs)(d.c,{children:[(0,a.jsx)(r.A,{color:"var(--privy-color-success)",width:"64px",height:"64px"}),(0,a.jsx)(c.C,{title:"Success!",description:`Youâ€™ve successfully added ${P} ${V} to your ${A.name} wallet. It may take a minute before the funds are available to use.`})]}),(0,a.jsx)(d.R,{}),(0,a.jsx)(l.B,{})]}):E&&Y?(0,a.jsx)(T.T,{walletClientType:(0,C.t)(Y?.standardWallet.name||"unknown"),displayName:J,addressToFund:H,isBridging:E,isErc20Flow:!1,chainId:M.id,chainName:M.name,totalPriceInUsd:void 0,totalPriceInNativeCurrency:void 0,gasPriceInUsd:void 0,gasPriceInNativeCurrency:void 0}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.t,{}),(0,a.jsx)(g.N,{}),(0,a.jsx)("div",{style:{marginTop:"1rem"}}),(0,a.jsx)(l.B,{})]})}}}};