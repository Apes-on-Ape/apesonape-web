"use strict";exports.id=3455,exports.ids=[3455],exports.modules={83455:(e,a,n)=>{n.r(a),n.d(a,{AwaitingEvmToSolBridgingScreen:()=>B,default:()=>B});var t=n(45512),i=n(90788),s=n(58009),r=n(7538),o=n(84126),d=n(53942),l=n(97922),c=n(445),u=n(20056),g=n(45549),h=n(65500),f=n(18064),m=n(75005),p=n(7666),v=n(98434),S=n(8601),b=n(76284),C=n(66658),T=n(37782),y=n(59677),w=n(32884),I=n(52760),E=n(87237),x=n(10721),N=n(6321),F=n(91505),A=n(46445),P=n(91746),U=n(71468);n(5327),n(7623),n(61889),n(25998),n(88527);let B={component:()=>{let e=(0,S.u)(),{rpcConfig:a,appId:n,closePrivyModal:B,createAnalyticsEvent:D}=(0,b.u)(),{navigate:L,setModalData:k,data:M}=(0,T.a)(),j=(0,S.u)(),{wallets:q}=(0,w.u)(),[H,J]=(0,s.useState)(null),[R,V]=(0,s.useState)(null),[W,Z]=(0,s.useState)([]),[$,G]=(0,s.useState)(0),[Y,z]=(0,s.useState)(!1),[O,Q]=(0,s.useState)(!1),[K,X]=(0,s.useState)(!1),[_,ee]=(0,s.useState)(!1),[ea,en]=(0,s.useState)(),[et,ei]=(0,s.useState)();if(!M?.funding||"solana"!==M.funding.chainType)throw Error("Invalid funding data");let{address:es,chain:er,connectedWallet:eo}=M.funding,[ed,el]=(0,s.useState)(M.funding.amount),ec=("ethereum"===eo?.type?eo:void 0)??q[0],eu=(0,C.Q)(ec?.walletClientType||"unknown"),eg=eu?.name||"wallet",[eh,ef]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{if(!ec)return;let e=await ec.getEthereumProvider();ef((0,r.F)({account:ec.address,transport:(0,o.I)(e)}).extend(d.$))})().catch(console.error)},[ec]);let[em,ep]=(0,s.useState)(0n),ev=(0,F.g)(em);(0,s.useEffect)(()=>{let a=e.solanaRpcs[er];a?(0,x.z)({rpc:a.rpc,address:es}).then(e=>ep(BigInt(e))).catch(console.error):console.warn("Unable to load solana rpc, skipping balance")},[]);let[eS,eb]=(0,s.useState)(),{tokenPrice:eC}=(0,y.u)("solana"),{fundingAmountInBaseUnit:eT,fundingAmountInUsd:ey}=(0,F.a)({amount:ed,fee:0n,tokenPrice:eC,isUsdc:M.funding.isUSDC});if((0,s.useEffect)(()=>{(async()=>{if(!eh||!ec)return;let e=["solana:testnet","solana:devnet"].includes(er);e&&console.warn("Solana testnets are not supported for bridging");let t=(0,g.u)(j.chains).filter(({testnet:a})=>!!a===e),i=(await (0,A.g)({chains:t,address:ec.address,appId:n,rpcConfig:a})).filter(e=>e.balance>0n);if(i.length<1)return void J(new b.a(`Wallet ${(0,C.D)(ec.address)} does not have enough funds.`,void 0,b.b.INSUFFICIENT_BALANCE));i.sort((e,a)=>Number(a.balance-e.balance));let s=(await Promise.allSettled(i.map(async e=>({...e,quote:await (0,E.g)({isTestnet:!1,input:(0,E.t)({appId:n,amount:eT.toString(),user:ec.address,recipient:es,destinationChainId:E.b,destinationCurrency:E.a,originChainId:e.chain.id})})})))).filter(e=>"fulfilled"===e.status).map(e=>e.value);if(s.length<1)return void J(new b.a(`Unable to fetch quotes for bridging. Wallet ${(0,C.D)(ec.address)} does not have enough funds.`,void 0,b.b.INSUFFICIENT_BALANCE));let r=s.map(({quote:e,balance:a,chain:n})=>({bridgeTx:(0,E.c)(e),balance:a,chain:n,isErc20Quote:!1})).filter(({bridgeTx:e})=>!!e);if(r.length>1)return void Z(r);let o=r.at(0);o?(Q(!0),eb({data:o.bridgeTx.data,to:o.bridgeTx.to,value:o.bridgeTx.value,chain:o.chain})):J(new b.a(`Unable to select bridge option from quotes. Wallet ${(0,C.D)(ec.address)} does not have enough funds.`,void 0,b.b.INSUFFICIENT_BALANCE))})().catch(console.error)},[eh]),(0,s.useEffect)(()=>{(async()=>{let e,t;if(!eh||!ec||Y||K||!eS)return;z(!0);let i=(0,l.l)({chain:eS.chain,transport:(0,c.L)((0,P.a)(eS.chain,a,n))});try{e=await i.prepareTransactionRequest({account:ec.address,to:eS.to,chain:eS.chain,data:eS.data,value:BigInt(eS.value??0)})}catch(e){console.error(e),W.length>1&&V(e.shortMessage??"Something went wrong")}if(e){z(!1),X(!0);try{await eh.switchChain({id:eS.chain.id})}catch(e){await eh.addChain({chain:eS.chain}),await eh.switchChain({id:eS.chain.id})}try{t=await eh.sendTransaction(e)}catch(e){console.error(e),"TransactionExecutionError"===e.name&&(W.length<1?J(new b.a(e.shortMessage,void 0,b.b.TRANSACTION_FAILURE)):V(e.shortMessage??"Something went wrong"))}if(t)return await eh.waitForTransactionReceipt({hash:t}),O?(ei("pending"),void en(t)):(X(!1),ee(!0),void D({eventName:I.O,payload:{provider:"external",status:"success",txHash:t,address:ec.address,chainId:eS.chain.id,chainType:"ethereum",value:eS.value?(0,u.J)(BigInt(eS.value),18):void 0,token:"ETH",destination:es,destinationClusterName:"mainnet-beta",destinationChainType:"solana",destinationValue:(0,u.J)(eT,9),destinationToken:"SOL"}}));X(!1)}else z(!1)})().catch(console.error)},[eh,eS]),(0,E.u)({transactionHash:ea,isTestnet:!1,bridgingStatus:et,setBridgingStatus:ei,onSuccess({transactionHash:e}){Q(!1),ee(!0),D({eventName:I.O,payload:{provider:"external",status:"success",txHash:e,address:ec?.address,chainId:eS?.chain.id,chainType:"ethereum",value:eS?.value?(0,u.J)(BigInt(eS.value),18):void 0,token:"ETH",destination:es,destinationClusterName:"mainnet-beta",destinationChainType:"solana",destinationValue:(0,u.J)(eT,9),destinationToken:"SOL"}})},onFailure({error:e}){Q(!1),J(e)}}),(0,s.useEffect)(()=>{H&&(k({funding:M?.funding,solanaFundingData:M?.solanaFundingData,sendTransaction:M?.sendTransaction,errorModalData:{error:H,previousScreen:"TransferFromWalletScreen"}}),L("ErrorScreen",!1))},[H]),(0,s.useEffect)(()=>{if(!_)return;let e=setTimeout(B,S.t);return()=>clearTimeout(e)},[_]),_)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.t,{}),(0,t.jsx)(h.b,{}),(0,t.jsxs)(h.c,{children:[(0,t.jsx)(i.A,{color:"var(--privy-color-success)",width:"64px",height:"64px"}),(0,t.jsx)(m.C,{title:"Success!",description:`Youâ€™ve successfully added ${ed} SOL to your ${j.name} wallet. It may take a minute before the funds are available to use.`})]}),(0,t.jsx)(h.R,{}),(0,t.jsx)(f.B,{})]});let ew=W[$];return W.length>1&&ew?(0,t.jsx)(A.B,{displayName:eg,configuredFundingChain:er,formattedBalance:ev,fundingAmount:ed,fundingCurrency:"SOL",fundingAmountInUsd:ey,options:W,selectedOption:ew,isPreparing:Y,isSubmitting:K,addressToFund:es,fundingWalletAddress:ec?.address||"",errorMessage:R,onSubmit:()=>{M.funding?.amount!==ed?(async function(){if(ec&&ew)try{let e=await (0,E.g)({isTestnet:!1,input:(0,E.t)({appId:n,amount:eT.toString(),user:ec.address,recipient:es,destinationChainId:E.b,destinationCurrency:E.a,originChainId:ew.chain.id})}),a=(0,E.c)(e);if(!a)throw Error("Invalid transaction request");Q(!0),eb({data:a.data,to:a.to,value:a.value,chain:ew.chain})}catch(e){console.error(e),J(new b.a("Unable to fetch quotes for bridging",e,b.b.INSUFFICIENT_BALANCE))}})().catch(console.error):eb({to:ew.bridgeTx.to,data:ew.bridgeTx.data,value:ew.bridgeTx.value,chain:ew.chain})},onSelect:e=>{e!==$&&(V(null),G(e))},onAmountChange:el}):K&&ec?(0,t.jsx)(U.T,{walletClientType:ec?.walletClientType||"unknown",displayName:eg,addressToFund:es,isBridging:O,isErc20Flow:!1,chainId:"solana",chainName:(0,N.g)(er),totalPriceInUsd:void 0,totalPriceInNativeCurrency:void 0,gasPriceInUsd:void 0,gasPriceInNativeCurrency:void 0}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.t,{}),(0,t.jsx)(v.N,{}),(0,t.jsx)("div",{style:{marginTop:"1rem"}}),(0,t.jsx)(f.B,{})]})}}},20451:(e,a,n)=>{n.d(a,{A:()=>o,D:()=>c,J:()=>l,L:()=>t,R:()=>d,S:()=>i,T:()=>s,a:()=>r,g:()=>u});let t=1e9,i="11111111111111111111111111111111",s="TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",r="TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb",o="ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",d=["CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C","CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"],l=["JUP6LkbZbjS1jKKwapdHNy74zcZ3tLUZoi5QNyVTaV4"],c={"solana:mainnet":{EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v:{symbol:"USDC",decimals:6,address:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"},Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB:{symbol:"USDT",decimals:6,address:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"},So11111111111111111111111111111111111111112:{symbol:"SOL",decimals:9,address:"So11111111111111111111111111111111111111112"}},"solana:devnet":{"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU":{symbol:"USDC",decimals:6,address:"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU"},EJwZgeZrdC8TXTQbQBoL6bfuAnFUUy1PVCMB4DYPzVaS:{symbol:"USDT",decimals:6,address:"EJwZgeZrdC8TXTQbQBoL6bfuAnFUUy1PVCMB4DYPzVaS"},So11111111111111111111111111111111111111112:{symbol:"SOL",decimals:9,address:"So11111111111111111111111111111111111111112"}},"solana:testnet":{}};function u(e,a){let n=parseFloat(e.toString())/t,i=g.format(a*n);return"$0.00"===i?"<$0.01":i}let g=new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2})},91505:(e,a,n)=>{n.d(a,{a:()=>s,g:()=>i});var t=n(20451);function i(e,a=6,n=!1,t=!1){let s=(parseFloat(e.toString())/1e9).toFixed(a).replace(/0+$/,"").replace(/\.$/,""),r=t?"":" SOL";return n?`${s}${r}`:`${"0"===s?"<0.001":s}${r}`}function s({amount:e,fee:a,tokenPrice:n,isUsdc:s}){let r=BigInt(Math.floor(parseFloat(e)*10**(s?6:9))),o=s?r:r+a;return{fundingAmountInBaseUnit:r,fundingAmountInUsd:n?(0,t.g)(r,n):void 0,totalPriceInUsd:n?(0,t.g)(o,n):void 0,totalPriceInNativeCurrency:i(o),feePriceInNativeCurrency:i(a),feePriceInUsd:n?(0,t.g)(a,n):void 0}}}};