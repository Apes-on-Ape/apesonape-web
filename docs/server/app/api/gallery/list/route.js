(()=>{var e={};e.id=1135,e.ids=[1135],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},7755:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>p,routeModule:()=>a,serverHooks:()=>l,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>u});var n=r(42706),i=r(28203),s=r(45994),o=r(77067);let a=new n.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/gallery/list/route",pathname:"/api/gallery/list",filename:"route",bundlePath:"app/api/gallery/list/route"},resolvedPagePath:"C:\\Users\\sebas\\Documents\\Git Projects\\apesonape-web\\app\\api\\gallery\\list\\route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:c,workUnitAsyncStorage:u,serverHooks:l}=a;function p(){return(0,s.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:u})}},23502:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"40fce7fe01bfa6906f6bb2dcfec8dbf08527633f40":()=>n.GET});var n=r(77067)},96487:()=>{},78335:()=>{},77067:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GET:()=>a});var n=r(88977);r(98063);var i=r(39187),s=r(73865),o=r(80922);async function a(e){try{let t=e.headers.get("x-admin-token")||"",{searchParams:r}=new URL(e.url),n=r.get("status")||"approved",a=r.get("category")||void 0,c=Math.min(parseInt(r.get("limit")||"24",10),100),u=Math.max(parseInt(r.get("offset")||"0",10),0),[l,p]=(r.get("sort")||"created_at:desc").split(":"),f="desc"!==(p||"desc").toLowerCase();if(t){let e=(0,o.r)(),r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxY3JiY3BtaW1mb2puamRodnJ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3MjE1ODEsImV4cCI6MjA4MDI5NzU4MX0.tlDiLyCdrOAULzLH9fv0rm5wpiHqy4nzDvmpC9xXRGw";if(!e||!r)return i.NextResponse.json({error:"Supabase config missing"},{status:500});let s=new URLSearchParams;n&&s.set("status",n),c&&s.set("limit",String(c));let a=await fetch(`${e}/gallery-moderate?${s.toString()}`,{headers:{apikey:r,Authorization:`Bearer ${r}`,"x-admin-token":t}}),u=await a.text();if(!a.ok)return i.NextResponse.json({error:u.slice(0,500)||"List failed"},{status:a.status});try{return i.NextResponse.json(JSON.parse(u))}catch{return i.NextResponse.json({raw:u})}}let d=(0,s.nz)().from("gallery_submissions").select("*",{count:"exact"}).eq("status",n);a&&(d=d.eq("category",a)),d=d.order(l||"created_at",{ascending:f}).range(u,u+c-1);let{data:g,error:y,count:m}=await d;if(y)return i.NextResponse.json({error:y.message},{status:500});return i.NextResponse.json({items:g??[],count:m??0})}catch(t){let e=t instanceof Error?t.message:"Unknown error";return i.NextResponse.json({error:e},{status:500})}}(0,r(56215).D)([a]),(0,n.A)(a,"40fce7fe01bfa6906f6bb2dcfec8dbf08527633f40",null)},80922:(e,t,r)=>{"use strict";function n(){try{let[e]=new URL("https://bqcrbcpmimfojnjdhvrz.supabase.co").host.split(".");return`https://${e}.functions.supabase.co`}catch{return""}}r.d(t,{r:()=>n})},73865:(e,t,r)=>{"use strict";r.d(t,{Bv:()=>a,nz:()=>o});var n=r(38013);let i=null,s=null;function o(){let e="https://bqcrbcpmimfojnjdhvrz.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxY3JiY3BtaW1mb2puamRodnJ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3MjE1ODEsImV4cCI6MjA4MDI5NzU4MX0.tlDiLyCdrOAULzLH9fv0rm5wpiHqy4nzDvmpC9xXRGw";if(!e||!t)throw Error("Missing Supabase env: NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY");return i||(i=(0,n.UU)(e,t,{auth:{persistSession:!1,autoRefreshToken:!1}}))}function a(){let e="https://bqcrbcpmimfojnjdhvrz.supabase.co",t=process.env.SUPABASE_SERVICE_ROLE_KEY||process.env.SERVICE_ROLE_KEY;return e&&t?s||(s=(0,n.UU)(e,t,{auth:{persistSession:!1,autoRefreshToken:!1}})):null}},56215:(e,t)=>{"use strict";function r(e){for(let t=0;t<e.length;t++){let r=e[t];if("function"!=typeof r)throw Error(`A "use server" file can only export async functions, found ${typeof r}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`)}}Object.defineProperty(t,"D",{enumerable:!0,get:function(){return r}})},88977:(e,t,r)=>{"use strict";Object.defineProperty(t,"A",{enumerable:!0,get:function(){return n.registerServerReference}});let n=r(46760)},54175:(e,t,r)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{arrayBufferToString:function(){return a},decrypt:function(){return l},encrypt:function(){return u},getActionEncryptionKey:function(){return y},getClientReferenceManifestForRsc:function(){return g},getServerModuleMap:function(){return d},setReferenceManifestsSingleton:function(){return f},stringToUint8Array:function(){return c}});let i=r(39212),s=r(62045),o=r(29294);function a(e){let t=new Uint8Array(e),r=t.byteLength;if(r<65535)return String.fromCharCode.apply(null,t);let n="";for(let e=0;e<r;e++)n+=String.fromCharCode(t[e]);return n}function c(e){let t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r}function u(e,t,r){return crypto.subtle.encrypt({name:"AES-GCM",iv:t},e,r)}function l(e,t,r){return crypto.subtle.decrypt({name:"AES-GCM",iv:t},e,r)}let p=Symbol.for("next.server.action-manifests");function f({page:e,clientReferenceManifest:t,serverActionsManifest:r,serverModuleMap:n}){var i;let o=null==(i=globalThis[p])?void 0:i.clientReferenceManifestsPerPage;globalThis[p]={clientReferenceManifestsPerPage:{...o,[(0,s.normalizeAppPath)(e)]:t},serverActionsManifest:r,serverModuleMap:n}}function d(){let e=globalThis[p];if(!e)throw new i.InvariantError("Missing manifest for Server Actions.");return e.serverModuleMap}function g(){let e=globalThis[p];if(!e)throw new i.InvariantError("Missing manifest for Server Actions.");let{clientReferenceManifestsPerPage:t}=e,r=o.workAsyncStorage.getStore();if(!r)return function(e){let t=Object.values(e),r={clientModules:{},edgeRscModuleMapping:{},rscModuleMapping:{}};for(let e of t)r.clientModules={...r.clientModules,...e.clientModules},r.edgeRscModuleMapping={...r.edgeRscModuleMapping,...e.edgeRscModuleMapping},r.rscModuleMapping={...r.rscModuleMapping,...e.rscModuleMapping};return r}(t);let n=t[r.route];if(!n)throw new i.InvariantError(`Missing Client Reference Manifest for ${r.route}.`);return n}async function y(){if(n)return n;let e=globalThis[p];if(!e)throw new i.InvariantError("Missing manifest for Server Actions.");let t=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||e.serverActionsManifest.encryptionKey;if(void 0===t)throw new i.InvariantError("Missing encryption key for Server Actions");return n=await crypto.subtle.importKey("raw",c(atob(t)),"AES-GCM",!0,["encrypt","decrypt"])}},98063:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{decryptActionBoundArgs:function(){return d},encryptActionBoundArgs:function(){return f}}),r(27315);let n=r(46760),i=r(8534),s=r(57212),o=r(54175),a=r(63033),c=new TextEncoder,u=new TextDecoder;async function l(e,t){let r=await (0,o.getActionEncryptionKey)();if(void 0===r)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=atob(t),i=n.slice(0,16),s=n.slice(16),a=u.decode(await (0,o.decrypt)(r,(0,o.stringToUint8Array)(i),(0,o.stringToUint8Array)(s)));if(!a.startsWith(e))throw Error("Invalid Server Action payload: failed to decrypt.");return a.slice(e.length)}async function p(e,t){let r=await (0,o.getActionEncryptionKey)();if(void 0===r)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=new Uint8Array(16);a.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(n));let i=(0,o.arrayBufferToString)(n.buffer),s=await (0,o.encrypt)(r,n,c.encode(e+t));return btoa(i+(0,o.arrayBufferToString)(s))}async function f(e,t){let{clientModules:r}=(0,o.getClientReferenceManifestForRsc)(),i=Error();Error.captureStackTrace(i,f);let c=!1,u=await (0,s.streamToString)((0,n.renderToReadableStream)(t,r,{onError(e){c||(c=!0,i.message=e instanceof Error?e.message:String(e))}}));if(c)throw i;let l=a.workUnitAsyncStorage.getStore();if(!l)return p(e,u);let d=(0,a.getPrerenderResumeDataCache)(l),g=(0,a.getRenderResumeDataCache)(l),y=e+u,m=(null==d?void 0:d.encryptedBoundArgs.get(y))??(null==g?void 0:g.encryptedBoundArgs.get(y));if(m)return m;let v="prerender"===l.type?l.cacheSignal:void 0;null==v||v.beginRead();let M=await p(e,u);return null==v||v.endRead(),null==d||d.encryptedBoundArgs.set(y,M),M}async function d(e,t){let{edgeRscModuleMapping:r,rscModuleMapping:n}=(0,o.getClientReferenceManifestForRsc)(),s=await l(e,await t);return await (0,i.createFromReadableStream)(new ReadableStream({start(e){e.enqueue(c.encode(s)),e.close()}}),{serverConsumerManifest:{moduleLoading:null,moduleMap:n,serverModuleMap:(0,o.getServerModuleMap)()}})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[638,8895,5452,8013],()=>r(7755));module.exports=n})();