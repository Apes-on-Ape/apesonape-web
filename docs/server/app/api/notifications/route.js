(()=>{var e={};e.id=2170,e.ids=[2170],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12075:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>x,routeModule:()=>d,serverHooks:()=>m,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>f});var s={};t.r(s),t.d(s,{GET:()=>p,PATCH:()=>c});var n=t(42706),o=t(28203),i=t(45994),a=t(39187),u=t(73865);async function p(e){try{let{searchParams:r}=new URL(e.url),t=r.get("userId"),s="true"===r.get("unreadOnly");if(!t)return a.NextResponse.json({error:"userId required"},{status:400});let n=(0,u.nz)().from("gamify_notifications").select("*").eq("glyph_user_id",t).order("created_at",{ascending:!1}).limit(50);s&&(n=n.eq("is_read",!1));let{data:o,error:i}=await n;if(i)return console.error("Error fetching notifications:",i),a.NextResponse.json({error:i.message},{status:500});return a.NextResponse.json({notifications:o||[]})}catch(r){let e=r instanceof Error?r.message:"Unknown error";return console.error("Error in notifications endpoint:",e),a.NextResponse.json({error:e},{status:500})}}async function c(e){try{let{notificationIds:r}=await e.json();if(!Array.isArray(r)||0===r.length)return a.NextResponse.json({error:"notificationIds array required"},{status:400});let t=(0,u.nz)(),{error:s}=await t.from("gamify_notifications").update({is_read:!0}).in("id",r);if(s)return console.error("Error marking notifications as read:",s),a.NextResponse.json({error:s.message},{status:500});return a.NextResponse.json({ok:!0})}catch(r){let e=r instanceof Error?r.message:"Unknown error";return console.error("Error in notifications PATCH endpoint:",e),a.NextResponse.json({error:e},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/notifications/route",pathname:"/api/notifications",filename:"route",bundlePath:"app/api/notifications/route"},resolvedPagePath:"C:\\Users\\sebas\\Documents\\Git Projects\\apesonape-web\\app\\api\\notifications\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:f,serverHooks:m}=d;function x(){return(0,i.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:f})}},96487:()=>{},78335:()=>{},73865:(e,r,t)=>{"use strict";t.d(r,{Bv:()=>a,nz:()=>i});var s=t(38013);let n=null,o=null;function i(){let e="https://bqcrbcpmimfojnjdhvrz.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxY3JiY3BtaW1mb2puamRodnJ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3MjE1ODEsImV4cCI6MjA4MDI5NzU4MX0.tlDiLyCdrOAULzLH9fv0rm5wpiHqy4nzDvmpC9xXRGw";if(!e||!r)throw Error("Missing Supabase env: NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY");return n||(n=(0,s.UU)(e,r,{auth:{persistSession:!1,autoRefreshToken:!1}}))}function a(){let e="https://bqcrbcpmimfojnjdhvrz.supabase.co",r=process.env.SUPABASE_SERVICE_ROLE_KEY||process.env.SERVICE_ROLE_KEY;return e&&r?o||(o=(0,s.UU)(e,r,{auth:{persistSession:!1,autoRefreshToken:!1}})):null}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,5452,8013],()=>t(12075));module.exports=s})();