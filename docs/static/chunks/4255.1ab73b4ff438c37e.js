"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4255],{6636:(e,t,a)=>{a.r(t),a.d(t,{EmbeddedWalletPasswordCreateScreen:()=>u,default:()=>u});var r=a(95155),s=a(12115),l=a(81084),o=a(24511),n=a(31679),c=a(48200),i=a(5944),d=a(70385);a(68943),a(29761),a(47147),a(89208),a(85243),a(80893),a(22234);let u={component:()=>{let{navigate:e,data:t,onUserCloseViaDialogOrKeybindRef:a}=(0,i.a)(),u=(0,l.u)(),[h,w]=(0,s.useState)(""),[y,v]=(0,s.useState)(!1),[p,f]=(0,s.useState)(),[S,m]=(0,s.useState)(null),{create:g}=(0,c.u)(),{authenticated:b,user:C}=(0,i.u)(),{closePrivyModal:P,isNewUserThisSession:U,initializeWalletProxy:E}=(0,n.u)(),{onSuccess:T,onFailure:x,callAuthOnSuccessOnClose:A,shouldCreateEth:k,shouldCreateSol:I}=t.createWallet,[M,O]=(0,s.useState)(null),W=new o.R(async()=>{try{let t;if(k&&I)t=await g({recoveryMethod:"user-passcode",recoveryPassword:p,chainType:"ethereum",walletIndex:0,latestUser:C}),t=await g({chainType:"solana",walletIndex:0,latestUser:t.user});else if(I)t=await g({recoveryMethod:"user-passcode",recoveryPassword:p,chainType:"solana",walletIndex:0,latestUser:C});else{if(!k)throw Error("Invalid args to create wallet");t=await g({recoveryMethod:"user-passcode",recoveryPassword:p,chainType:"ethereum",walletIndex:0,latestUser:C})}O(t),U?e("EmbeddedWalletCreatedScreen"):(T(t),P({shouldCallAuthOnSuccess:A}))}catch(e){w(e.message)}});return(0,s.useEffect)(()=>{S||E(3e4).then(e=>m(e))},[S]),(0,s.useEffect)(()=>{if(!b||!C)return e("LandingScreen"),void x(Error("User must be authenticated before creating a Privy wallet"))},[b]),a.current=()=>null,(0,r.jsx)(d.S,{config:{initiatedBy:"automatic"},appName:u?.name||"privy",loading:!S,buttonLoading:y,buttonHideAnimations:!M&&y,isResettingPassword:!1,error:h,password:p||"",onClose:()=>{M&&"user-passcode"!==M.account.recoveryMethod?(x(new n.l("User created a wallet but failed to set a password for it")),P({shouldCallAuthOnSuccess:!1})):M?(T(M),P({shouldCallAuthOnSuccess:A})):(x(new n.l("User wallet creation failed")),P({shouldCallAuthOnSuccess:!1}))},onPasswordChange:f,onPasswordGenerate:()=>f((0,d.g)()),onSubmit:async()=>(v(!0),W.execute().then(()=>new Promise(e=>setTimeout(e,250))).finally(()=>v(!1)))})}}},48200:(e,t,a)=>{a.d(t,{u:()=>o});var r=a(45687),s=a(81084),l=a(31679);let o=()=>{let{walletProxy:e,recoverEmbeddedWallet:t,setUser:a,refreshSessionAndUser:o,privy:n,client:c}=(0,l.u)(),i=(0,s.u)();return{create:async({walletIndex:s,chainType:l,latestUser:d,recoveryMethod:u,recoveryPassword:h,recoveryAccessToken:w})=>{let y=d;y||(y=await o());let v=await c.getAccessToken();if(!y||!v||!e)throw Error("User must be authenticated before creating a Privy wallet");return await (0,r.g)({appConfig:i,user:y,refreshSessionAndUser:o,privy:n,accessToken:v,proxy:e,recoverEmbeddedWallet:t,setUser:a,walletIndex:s,chainType:l,recoveryMethod:u,recoveryPassword:h,recoveryAccessToken:w})}}}}}]);