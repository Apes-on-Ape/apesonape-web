(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6235],{83649:(e,t,r)=>{Promise.resolve().then(r.bind(r,79658))},77674:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});var l=r(95155),o=r(5565);function a(e){let{src:t,alt:r,className:a,width:s=800,height:n=800,fill:i=!1,sizes:d="100vw",unoptimized:c=!0,priority:u=!1}=e,h=t||"/placeholder.png";return i?(0,l.jsx)(o.default,{src:h,alt:r,fill:!0,sizes:d,unoptimized:c,className:a,priority:u}):(0,l.jsx)(o.default,{src:h,alt:r,width:s,height:n,sizes:d,unoptimized:c,className:a,priority:u})}r(12115)},79658:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var l=r(95155),o=r(12115),a=r(48173),s=r.n(a),n=r(77711),i=r(76046);let d=(0,r(67401).A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var c=r(16075),u=r(77674),h=r(21833);let f=(0,n.default)(()=>r.e(293).then(r.bind(r,20293)),{loadableGenerated:{webpack:()=>[20293]},ssr:!1});function m(){var e;let t=(0,i.useSearchParams)(),r=(0,i.useRouter)(),a=(0,h.j)(),n=(null==a?void 0:null===(e=a.user)||void 0===e?void 0:e.id)||"",m=t.get("category")||"all",[b,x]=(0,o.useState)([]),[p,g]=(0,o.useState)(new Set),[y,v]=(0,o.useState)({}),[w,j]=(0,o.useState)(!0),[N,_]=(0,o.useState)(null),[k,S]=(0,o.useState)(m),[C,P]=(0,o.useState)("top");(0,o.useEffect)(()=>{try{let e=localStorage.getItem("gallery_voted_ids")||"[]",t=JSON.parse(e);g(new Set(t));let r=localStorage.getItem("gallery_vote_snapshot")||"{}",l=JSON.parse(r);v(l||{})}catch(e){g(new Set),v({})}},[]),(0,o.useEffect)(()=>{let e=!1;return(async()=>{try{j(!0);let t=new URLSearchParams({status:"approved",sort:"top"===C?"votes_count:desc":"created_at:desc",limit:"60"});"all"!==k&&t.set("category",k);let r=await fetch("/api/gallery/list/?".concat(t.toString()),{cache:"no-store"}),l=await r.json();if(!e){let e=(l.items||[]).map(e=>{var t;let r=null!==(t=e.votes_count)&&void 0!==t?t:0,l=y[e.id];return{...e,votes_count:Math.max(r,void 0!==l?l+1:r)}});x(e)}}catch(t){e||_(t instanceof Error?t.message:"Failed to load")}finally{e||j(!1)}})(),()=>{e=!0}},[k,C,y]),(0,o.useEffect)(()=>{let e=new URLSearchParams;"all"!==k&&e.set("category",k),r.replace("/gallery".concat(e.toString()?"?".concat(e.toString()):""))},[k]);let A=async e=>{var t,r;if(p.has(e))return;let l=null!==(r=null===(t=b.find(t=>t.id===e))||void 0===t?void 0:t.votes_count)&&void 0!==r?r:0;try{let t=await fetch("/api/gallery/vote/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({submission_id:e,likerId:n||void 0})});if(!t.ok)return;let r=null;try{let e=await t.json();if(e&&"object"==typeof e&&null!==e&&"count"in e){let t=e.count;"number"==typeof t&&(r=t)}}catch(e){}x(t=>t.map(t=>{if(t.id!==e)return t;let l=null!==r?r:(t.votes_count||0)+1;return{...t,votes_count:l}})),g(t=>{let r=new Set(t);r.add(e);try{localStorage.setItem("gallery_voted_ids",JSON.stringify(Array.from(r)))}catch(e){}return r}),v(t=>{let r={...t};void 0===r[e]&&(r[e]=l);try{localStorage.setItem("gallery_vote_snapshot",JSON.stringify(r))}catch(e){}return r})}catch(e){}},O=e=>{let t="".concat(window.location.origin,"/gallery/").concat(e.id),r="Community art: ".concat(e.title||"Check this out!"," #ApesOnApe"),l="https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(r),"&url=").concat(encodeURIComponent(t),"&hashtags=ApesOnApe");window.open(l,"_blank","noopener,noreferrer")};return(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("h1",{className:"text-2xl md:text-3xl font-semibold",style:{color:"var(--foreground)"},children:"Community Gallery"}),(0,l.jsxs)("div",{className:"hidden md:flex items-center gap-2 ml-2",children:[(0,l.jsx)("button",{className:"px-3 py-1.5 rounded-full text-sm border ".concat("all"===k?"bg-hero-blue/20 border-hero-blue/40 text-hero-blue":"border-white/15 text-off-white/80"),onClick:()=>S("all"),children:"All"}),(0,l.jsx)("button",{className:"px-3 py-1.5 rounded-full text-sm border ".concat("fan_art"===k?"bg-hero-blue/20 border-hero-blue/40 text-hero-blue":"border-white/15 text-off-white/80"),onClick:()=>S("fan_art"),children:"Fan Art"}),(0,l.jsx)("button",{className:"px-3 py-1.5 rounded-full text-sm border ".concat("spotlight"===k?"bg-hero-blue/20 border-hero-blue/40 text-hero-blue":"border-white/15 text-off-white/80"),onClick:()=>S("spotlight"),children:"Spotlight"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("select",{value:C,onChange:e=>P(e.target.value),className:"rounded-md bg-black/40 border border-white/10 p-2 text-sm",children:[(0,l.jsx)("option",{value:"top",children:"Top (votes)"}),(0,l.jsx)("option",{value:"new",children:"New"})]}),(0,l.jsx)(f,{variant:"header"})]})]}),(0,l.jsxs)("div",{className:"flex md:hidden items-center gap-2 mb-4",children:[(0,l.jsx)("button",{className:"px-3 py-1.5 rounded-full text-sm border ".concat("all"===k?"bg-hero-blue/20 border-hero-blue/40 text-hero-blue":"border-white/15 text-off-white/80"),onClick:()=>S("all"),children:"All"}),(0,l.jsx)("button",{className:"px-3 py-1.5 rounded-full text-sm border ".concat("fan_art"===k?"bg-hero-blue/20 border-hero-blue/40 text-hero-blue":"border-white/15 text-off-white/80"),onClick:()=>S("fan_art"),children:"Fan Art"}),(0,l.jsx)("button",{className:"px-3 py-1.5 rounded-full text-sm border ".concat("spotlight"===k?"bg-hero-blue/20 border-hero-blue/40 text-hero-blue":"border-white/15 text-off-white/80"),onClick:()=>S("spotlight"),children:"Spotlight"})]}),w&&(0,l.jsx)("p",{className:"text-off-white/80",children:"Loading..."}),N&&(0,l.jsx)("p",{className:"text-red-400",children:N}),!w&&!N&&0===b.length&&(0,l.jsxs)("div",{className:"rounded-xl border border-white/10 bg-black/30 p-6 text-off-white/80",children:["No submissions yet. Be the first to ",(0,l.jsx)(f,{variant:"empty"}),"."]}),!w&&!N&&b.length>0&&(0,l.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-5",children:b.map(e=>{var t;let r=function(e){if(!e)return!1;let t=e.toLowerCase();return t.endsWith(".mp4")||t.endsWith(".webm")||t.endsWith(".mov")||t.endsWith(".m4v")}(e.image_url||void 0);return(0,l.jsxs)("div",{className:"group rounded-xl border border-white/20 bg-black/50 hover:bg-black/60 transition-colors overflow-hidden flex flex-col shadow-xl shadow-black/40",children:[(0,l.jsxs)(s(),{href:"/gallery/".concat(e.id),className:"block relative",children:[(0,l.jsx)("div",{className:"aspect-[4/3] w-full overflow-hidden",children:r?(0,l.jsx)("video",{className:"w-full h-full object-cover",muted:!0,playsInline:!0,preload:"metadata",children:(0,l.jsx)("source",{src:e.image_url||""})}):e.image_url?(0,l.jsx)(u.default,{src:e.image_url||"",alt:e.title,className:"w-full h-full object-cover",fill:!0}):(0,l.jsx)("div",{className:"w-full h-full bg-white/5 flex items-center justify-center text-off-white/60",children:"No media"})}),(0,l.jsxs)("div",{className:"absolute inset-x-0 bottom-0 p-3 bg-gradient-to-t from-black/70 to-transparent",children:[(0,l.jsx)("div",{className:"text-sm text-off-white/80",children:e.author||"Anonymous"}),(0,l.jsx)("div",{className:"font-semibold",style:{color:"var(--foreground)"},children:e.title})]})]}),(0,l.jsxs)("div",{className:"p-3 flex items-center gap-2 mt-auto flex-wrap",children:[(0,l.jsxs)("button",{onClick:()=>A(e.id),disabled:p.has(e.id),className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border-2 transition-all duration-200 active:scale-95 disabled:opacity-60 disabled:cursor-not-allowed\n											".concat(p.has(e.id)?"border-rose-400/60 bg-rose-500/10 text-rose-300":"border-hero-blue/40 hover:border-hero-blue hover:bg-hero-blue/10"),"aria-pressed":p.has(e.id),children:[(0,l.jsx)(d,{className:"w-4 h-4 ".concat(p.has(e.id)?"fill-rose-400 text-rose-400":"text-hero-blue")}),(0,l.jsx)("span",{children:p.has(e.id)?"Liked":"Like"}),(0,l.jsxs)("span",{className:"opacity-80",children:["(",null!==(t=e.votes_count)&&void 0!==t?t:0,")"]})]}),(0,l.jsxs)("button",{onClick:()=>O(e),className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border-2 border-hero-blue/40 hover:border-hero-blue hover:bg-hero-blue/10 transition-colors",children:[(0,l.jsx)(c.A,{className:"w-4 h-4 text-hero-blue"}),(0,l.jsx)("span",{children:"Share"})]})]})]},e.id)})})]})}},67401:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var l=r(12115);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,l.forwardRef)((e,t)=>{let{color:r="currentColor",size:o=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:d="",children:c,iconNode:u,...h}=e;return(0,l.createElement)("svg",{ref:t,...s,width:o,height:o,stroke:r,strokeWidth:i?24*Number(n)/Number(o):n,className:a("lucide",d),...h},[...u.map(e=>{let[t,r]=e;return(0,l.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),i=(e,t)=>{let r=(0,l.forwardRef)((r,s)=>{let{className:i,...d}=r;return(0,l.createElement)(n,{ref:s,iconNode:t,className:a("lucide-".concat(o(e)),i),...d})});return r.displayName="".concat(e),r}},16075:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});let l=(0,r(67401).A)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])},77711:(e,t,r)=>{"use strict";r.d(t,{default:()=>o.a});var l=r(21956),o=r.n(l)},76046:(e,t,r)=>{"use strict";var l=r(66658);r.o(l,"useRouter")&&r.d(t,{useRouter:function(){return l.useRouter}}),r.o(l,"useSearchParams")&&r.d(t,{useSearchParams:function(){return l.useSearchParams}})},21956:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let l=r(60306)._(r(30580));function o(e,t){var r;let o={};"function"==typeof e&&(o.loader=e);let a={...o,...t};return(0,l.default)({...a,modules:null==(r=a.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},39827:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return o}});let l=r(93719);function o(e){let{reason:t,children:r}=e;if("undefined"==typeof window)throw new l.BailoutToCSRError(t);return r}},30580:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let l=r(95155),o=r(12115),a=r(39827),s=r(79214);function n(e){return{default:e&&"default"in e?e.default:e}}let i={loader:()=>Promise.resolve(n(()=>null)),loading:null,ssr:!0},d=function(e){let t={...i,...e},r=(0,o.lazy)(()=>t.loader().then(n)),d=t.loading;function c(e){let n=d?(0,l.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,i=!t.ssr||!!t.loading,c=i?o.Suspense:o.Fragment,u=t.ssr?(0,l.jsxs)(l.Fragment,{children:["undefined"==typeof window?(0,l.jsx)(s.PreloadChunks,{moduleIds:t.modules}):null,(0,l.jsx)(r,{...e})]}):(0,l.jsx)(a.BailoutToCSR,{reason:"next/dynamic",children:(0,l.jsx)(r,{...e})});return(0,l.jsx)(c,{...i?{fallback:n}:{},children:u})}return c.displayName="LoadableComponent",c}},79214:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return n}});let l=r(95155),o=r(47650),a=r(75861),s=r(18284);function n(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let r=a.workAsyncStorage.getStore();if(void 0===r)return null;let n=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files;n.push(...t)}}return 0===n.length?null:(0,l.jsx)(l.Fragment,{children:n.map(e=>{let t=r.assetPrefix+"/_next/"+(0,s.encodeURIPath)(e);return e.endsWith(".css")?(0,l.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,o.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5328,7532,5783,554,5565,9623,8441,1517,7358],()=>t(83649)),_N_E=e.O()}]);