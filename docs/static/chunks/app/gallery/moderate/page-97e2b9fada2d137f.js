(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2549],{44570:(e,t,a)=>{Promise.resolve().then(a.bind(a,42755))},77674:(e,t,a)=>{"use strict";a.d(t,{default:()=>r});var l=a(95155),s=a(5565);function r(e){let{src:t,alt:a,className:r,width:n=800,height:i=800,fill:o=!1,sizes:c="100vw",unoptimized:d=!0,priority:u=!1}=e,m=t||"/placeholder.png";return o?(0,l.jsx)(s.default,{src:m,alt:a,fill:!0,sizes:c,unoptimized:d,className:r,priority:u}):(0,l.jsx)(s.default,{src:m,alt:a,width:n,height:i,sizes:c,unoptimized:d,className:r,priority:u})}a(12115)},42755:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var l=a(95155),s=a(12115),r=a(77674);function n(){let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(""),[i,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)(null);(0,s.useEffect)(()=>{n(localStorage.getItem("gallery_admin_token")||localStorage.getItem("ugc_admin_token")||"")},[]),(0,s.useEffect)(()=>{let e=!1;return(async()=>{if(!a){e||(o(!1),t([]),d(null));return}try{o(!0),d(null);let l=await fetch("/api/gallery/list/?status=pending&limit=100&sort=created_at:asc",{cache:"no-store",headers:a?{"x-admin-token":a}:void 0}),s=l.headers.get("content-type")||"";if(!l.ok){let e=await l.text().catch(()=>"");throw Error("List failed ".concat(l.status,": ").concat(e.slice(0,200)))}if(!s.includes("application/json")){let e=await l.text().catch(()=>"");throw Error("Unexpected response (not JSON): ".concat(e.slice(0,200)))}let r=await l.json();e||t(r.items||[])}catch(t){e||d(t instanceof Error?t.message:"Failed to load pending items")}finally{e||o(!1)}})(),()=>{e=!0}},[a]);let u=async(e,l)=>{(await fetch("/api/gallery/moderate/",{method:"POST",headers:{"Content-Type":"application/json","x-admin-token":a||""},body:JSON.stringify({id:e,status:l})})).ok&&t(t=>t.filter(t=>t.id!==e))};return(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold mb-4",style:{color:"var(--foreground)"},children:"Gallery Moderation"}),(0,l.jsxs)("div",{className:"rounded-xl border border-white/20 bg-black/60 p-4 mb-6 shadow-2xl",children:[(0,l.jsx)("label",{className:"block text-sm mb-1",children:"Admin Token"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{value:a,onChange:e=>n(e.target.value),className:"flex-1 rounded-md bg-black/40 border border-white/10 p-2"}),(0,l.jsx)("button",{onClick:()=>{localStorage.setItem("gallery_admin_token",a),localStorage.getItem("ugc_admin_token")&&localStorage.removeItem("ugc_admin_token"),n(e=>e)},className:"btn-secondary",children:"Save"})]}),(0,l.jsx)("p",{className:"text-xs text-off-white/60 mt-2",children:"Set server env UGC_ADMIN_TOKEN and paste here."})]}),i&&(0,l.jsx)("p",{className:"text-off-white/80",children:"Loading..."}),c&&(0,l.jsx)("p",{className:"text-red-400",children:c}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(e=>(0,l.jsxs)("div",{className:"rounded-xl border border-white/20 bg-black/50 p-3 shadow-lg",children:[(0,l.jsx)("div",{className:"rounded-md overflow-hidden mb-3",children:e.image_url?(0,l.jsx)(r.default,{src:e.image_url,alt:e.title,className:"w-full h-52 object-cover",width:400,height:208,unoptimized:!0}):(0,l.jsx)("div",{className:"w-full h-52 bg-white/5 flex items-center justify-center text-off-white/60",children:"No media"})}),(0,l.jsx)("h3",{className:"font-semibold",style:{color:"var(--foreground)"},children:e.title}),(0,l.jsxs)("p",{className:"text-sm text-off-white/70 mb-3",children:[e.author||"Anonymous"," â€” ",e.category||"fan_art"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{className:"btn-primary",onClick:()=>u(e.id,"approved"),children:"Approve"}),(0,l.jsx)("button",{className:"btn-secondary",onClick:()=>u(e.id,"rejected"),children:"Reject"})]})]},e.id))})]})}},45353:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return s}});let l=a(12115);function s(e,t){let a=(0,l.useRef)(()=>{}),s=(0,l.useRef)(()=>{});return(0,l.useMemo)(()=>e&&t?l=>{null===l?(a.current(),s.current()):(a.current=r(e,l),s.current=r(t,l))}:e||t,[e,t])}function r(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let a=e(t);return"function"==typeof a?a:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}},e=>{var t=t=>e(e.s=t);e.O(0,[5565,8441,1517,7358],()=>t(44570)),_N_E=e.O()}]);