"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8547],{68547:(e,t,s)=>{s.r(t),s.d(t,{MfaVerifyFlowScreen:()=>u,default:()=>u});var r=s(95155),l=s(12115),n=s(5944),o=s(24511),a=s(92247);s(68943),s(29761),s(47147),s(89208),s(85243);let u=({onClose:e})=>{let{user:t}=(0,n.u)(),[s,u]=(0,l.useState)(t?.mfaMethods[0]??null),{init:c,cancel:i,submit:f}=(0,o.u)(),[d,h]=(0,l.useState)(!1),[k,w]=(0,l.useState)(null),[y,m]=(0,l.useState)();(0,l.useEffect)(()=>{u(t?.mfaMethods[0]??null)},[t?.mfaMethods]);let S=(0,l.useRef)(!1);async function v(t){m(void 0);try{if(!t||!s)return;await f(s,t),h(!0),m(void 0),e()}catch(e){throw(0,a.t)(e).error}}async function b(t){if("passkey"!==t)try{u(t),await c(t)}catch(e){console.error(e)}else try{u(t);let s=await c(t);if(!s)throw Error("something went wrong");w(s),await f(t,s),h(!0),m(void 0),e()}catch(e){m((0,a.t)(e))}}(0,l.useEffect)(()=>{!S.current&&s&&(S.current=!0,b(s).finally(()=>{S.current=!1}))},[]);let g=()=>{u(null),m(void 0),i(),e()};return t?"passkey"===s?(0,r.jsx)(a.V,{account:t.linkedAccounts.filter(e=>"passkey"===e.type&&e.enrolledInMfa).sort((e,t)=>t.firstVerifiedAt.valueOf()-e.firstVerifiedAt.valueOf())[0],submitSuccess:d,hasBlockingError:y?.isBlocking??!1,error:y?.error,onClose:g,onBack:()=>{u(null),m(void 0)},handleSubmit:()=>v(k).catch(m)}):s?(0,r.jsx)(a.a,{submitSuccess:d,hasBlockingError:y?.isBlocking??!1,handleSubmitCode:v,selectedMethod:s,onClose:g,onBack:t.mfaMethods.length>1?()=>u(null):void 0}):(0,r.jsx)(a.b,{user:t,onSelect:b,handleClose:g}):null}}}]);