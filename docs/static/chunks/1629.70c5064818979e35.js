"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1629],{81629:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var s=i(95155),a=i(12115),l=i(67401);let n=(0,l.A)("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),r=(0,l.A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var o=i(21833);function d(){var e;let t=(0,o.j)(),i=(null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.id)||"",[l,d]=(0,a.useState)(!1),[c,h]=(0,a.useState)([]),[f,x]=(0,a.useState)(!1),u=(0,a.useCallback)(async()=>{if(i)try{x(!0);let e=await fetch("/api/notifications?userId=".concat(encodeURIComponent(i),"&unreadOnly=false"),{cache:"no-store"});if(!e.ok)return;let t=await e.json();Array.isArray(null==t?void 0:t.notifications)&&h(t.notifications)}finally{x(!1)}},[i]);(0,a.useEffect)(()=>{l&&u()},[l,i,u]);let m=c.filter(e=>!e.is_read).length,b=async e=>{if(e.length)try{await fetch("/api/notifications",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:e})}),h(t=>t.map(t=>e.includes(t.id)?{...t,is_read:!0}:t))}catch(e){}};return((0,a.useEffect)(()=>{l&&m>0&&b(c.filter(e=>!e.is_read).map(e=>e.id))},[l,m]),i)?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>{d(e=>!e)},className:"relative inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/5 border border-white/10 hover:border-white/30 transition-colors",title:"Notifications",children:[(0,s.jsx)(n,{className:"w-5 h-5 text-off-white"}),m>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 text-[11px] px-1.5 py-0.5 rounded-full bg-hero-blue text-white",children:m})]}),l&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-80 max-h-96 overflow-auto glass-dark rounded-xl border border-white/10 shadow-xl z-50 p-3 space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("div",{className:"text-sm font-semibold",children:"Notifications"}),m>0&&(0,s.jsxs)("button",{className:"text-xs text-hero-blue flex items-center gap-1",onClick:()=>b(c.filter(e=>!e.is_read).map(e=>e.id)),children:[(0,s.jsx)(r,{className:"w-3 h-3"})," Mark read"]})]}),f?(0,s.jsx)("div",{className:"text-xs text-off-white/60",children:"Loading..."}):0===c.length?(0,s.jsx)("div",{className:"text-xs text-off-white/60",children:"No notifications yet."}):c.map(e=>(0,s.jsxs)("div",{className:"p-3 rounded-lg border ".concat(e.is_read?"border-white/10 bg-white/5":"border-hero-blue/30 bg-hero-blue/5"),children:[(0,s.jsx)("div",{className:"text-sm font-semibold",children:e.title}),(0,s.jsx)("div",{className:"text-xs text-off-white/70",children:e.message}),e.bananas_earned>0&&(0,s.jsxs)("div",{className:"text-[11px] text-yellow-400 mt-1",children:["\uD83C\uDF4C +",e.bananas_earned]}),(0,s.jsx)("div",{className:"text-[10px] text-off-white/50 mt-1",children:new Date(e.created_at).toLocaleString()})]},e.id))]})]}):null}}}]);